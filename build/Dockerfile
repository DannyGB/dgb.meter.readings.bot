FROM golang:1.19.1

RUN mkdir /app

COPY . /app

WORKDIR /app/cmd/meter.readings.bot

ARG HTTP_PORT=80
ENV METER_READINGS_HTTP_PORT $HTTP_PORT

ARG TELEGRAM_BOT_TOKEN
ENV METER_READINGS_TELEGRAM_BOT_TOKEN $TELEGRAM_BOT_TOKEN

ARG TELEGRAM_CHANNEL_ID
ENV METER_READINGS_TELEGRAM_CHANNEL_ID: $TELEGRAM_CHANNEL_ID

ARG TELEGRAM_VALID_USERS
ENV METER_READINGS_TELEGRAM_VALID_USERS: $TELEGRAM_VALID_USERS

ARG HTTP_PORT=80
ENV METER_READINGS_HTTP_PORT $HTTP_PORT

RUN go build -o meter.readings.bot .

CMD [ "/app/cmd/meter.readings.bot/meter.readings.bot" ]
